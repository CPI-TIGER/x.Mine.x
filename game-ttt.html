<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>دوز | Tic-Tac-Toe | x.Mine.x Mini Games</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="style.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark fixed-top"><div class="container"><a class="navbar-brand" href="minigames.html">برگشت به بازی‌ها</a></div></nav>
<main style="margin-top:85px;min-height:65vh"><div class="container"><div class="row"><div class="col-lg-6 mx-auto minigame-box"><div class="minigame-title">دوز (Tic-Tac-Toe)</div><div style="margin-bottom:1rem"><label for="ai-level" style="font-weight:700;margin-left:0.7rem;">درجه سختی:</label><select id="ai-level" class="form-select" style="width:126px;display:inline-block;margin-right:8px"><option value="easy">آسان</option><option value="med" selected>متوسط</option><option value="hard">سخت</option></select></div><button id="ttt-start" class="btn btn-primary w-100 mb-2">شروع بازی</button><div class="minigame-desc">شما X هستید، ابتدا حرکت می‌کنید.</div><div id="ttt-board" style="display:grid;grid-template-columns:repeat(3,48px);gap:7px;justify-content:center;margin:0 auto 1.2rem auto;"></div><div id="ttt-result" style="min-height:40px;"></div><button id="ttt-restart" class="btn btn-outline-light w-100 mt-2" style="display:none">شروع مجدد</button></div></div></div></main>
<script>let board=["","","","","","","","",""],isUser=true,finished=false,level="med",started=false;const lvlSel=document.getElementById('ai-level');const btnStart=document.getElementById('ttt-start');const btnRestart=document.getElementById('ttt-restart');const result=document.getElementById('ttt-result');lvlSel.onchange=function(){if(!started||finished){level=this.value;resetUI(false);}else{this.value=level}};btnStart.onclick=function(){resetUI(true)};btnRestart.onclick=function(){resetUI(true)};function resetUI(go){board=["","","","","","","","",""];isUser=true;finished=false;started=!!go;draw()}function aiBestMove(){if(level==="easy"){let moves=[];for(let i=0;i<9;i++)if(!board[i])moves.push(i);return moves.length?moves[Math.floor(Math.random()*moves.length)]:-1}if(level==="hard"){for(let i=0;i<9;i++)if(!board[i]){board[i]='O';if(checkWin('O')){board[i]='';return i}board[i]=''}for(let i=0;i<9;i++)if(!board[i]){board[i]='X';if(checkWin('X')){board[i]='';return i}board[i]=''}if(!board[4])return 4;let corners=[0,2,6,8].filter(i=>!board[i]);if(corners.length)return corners[0];let sides=[1,3,5,7].filter(i=>!board[i]);if(sides.length)return sides[0];for(let i=0;i<9;i++)if(!board[i])return i;return -1}if(level==="med"){for(let i=0;i<9;i++)if(!board[i]){board[i]='O';if(checkWin('O')){board[i]='';return i}board[i]=''}for(let i=0;i<9;i++)if(!board[i]){board[i]='X';if(checkWin('X')){board[i]='';return i}board[i]=''}let moves=[];[0,2,6,8].forEach(i=>{if(!board[i])moves.push(i)});if(moves.length)return moves[Math.floor(Math.random()*moves.length)];if(!board[4])return 4;for(let i=0;i<9;i++)if(!board[i])moves.push(i);return moves.length?moves[Math.floor(Math.random()*moves.length)]:-1}}function checkWin(p){const w=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];return w.some(comb=>comb.every(idx=>board[idx]===p))}function draw(){const b=document.getElementById('ttt-board');b.innerHTML='';for(let i=0;i<9;i++){const el=document.createElement('div');el.className='ttt-cell';el.style.cssText='width:48px;height:48px;font-size:2.1rem;display:flex;align-items:center;justify-content:center;background:rgba(6,182,212,0.08);border-radius:8px;cursor:'+(board[i]||finished||!started?'default':'pointer')+';color:var(--primary-color);font-weight:800;transition:all 0.2s;box-shadow:0 1.5px 7px 1.5px rgba(0,0,0,0.07)';el.innerText=board[i];if(!board[i]&&!finished&&started)el.onclick=function(){if(isUser){board[i]='X';isUser=false;draw();setTimeout(aiMove,300)}};b.appendChild(el);}updateResult();btnRestart.style.display=started?'block':'none';btnStart.style.display=started?'none':'block';lvlSel.disabled=started&&!finished}function aiMove(){if(finished||!started)return;let idx=aiBestMove();if(idx!==-1){board[idx]='O';isUser=true;draw()}}function updateResult(){if(!started){result.innerHTML='برای شروع بازی، درجه سختی را انتخاب کن و دکمه "شروع بازی" را بزن';return;}if(checkWin('X')){result.innerHTML='شما <b>برنده</b> شدید!';finished=true}else if(checkWin('O')){result.innerHTML='هوش مصنوعی <b>برنده</b> شد.';finished=true}else if(board.every(c=>c)){result.innerHTML='بازی <b>مساوی</b> شد.';finished=true}else{result.innerHTML='نوبت شماست.'}if(finished)lvlSel.disabled=false;}resetUI(false);
</script>
</body></html>
